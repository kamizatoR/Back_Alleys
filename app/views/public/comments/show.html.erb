<div class="row mt-5">
    <div class="col-10 text-center">

      <div class="row mb-3">
          <%= link_to  timeline_path(@comment.end_user.display_name), class: "text-decoration-none text-dark" do  %>
            <%= image_tag @comment.end_user.get_image, size: "40x40", class: "rounded-circle" %>
            <strong><%= @comment.end_user.display_name %></strong> <i class="fas fa-comment"></i>
          <% end %>
          <%= link_to post_path(@post.end_user.display_name, @post.id), class: "text-decoration-none text-info"  do %>
            <small class="ml-3">返信先<%= @comment.post.end_user.display_name %></small>
          <% end %>
      </div>

      <div class="row justify-content-center mt-4">
        <%= @comment.body %>
      </div>

    </div>

  <% if end_user_signed_in? && @comment.end_user_id == current_end_user.id  %>
    <div class="col-2 pl-0">
      <ul class="list-unstyled">
        <li class="mb-2">
          <%= link_to  edit_comment_path(@post.end_user.display_name, @post.id, @comment.id), class: "btn btn-outline-success" do %>
             編集 <i class="fas fa-solid fa-pen-to-square"></i>
          <% end %>
        </li>
        <li>
          <%= link_to  destroy_comment_path(@post.end_user.display_name, @post.id, @comment.id), method: :delete, class: "btn btn-outline-danger", "data-confirm"=> "本当に削除しますか？" do %>
              削除 <i class="fas fa-solid fa-trash"></i>
          <% end %>
        </li>
      </ul>
    </div>
  <% end %>

</div>

<div class="row mt-5 mb-2 border-top border-bottom">
  <div class="col-5 pt-2 text-center">
    <i class="fas fa-solid fa-reply"></i> <%= @comment.replies.count %>件
  </div>
  <div class="col-5  pt-2">
    ♥ <%= @comment.likes.count %>件
  </div>

  <% if current_end_user.liked_by?(current_end_user.id, @comment.id) %>
    <%= link_to "♥", unliked_path(table_id: @comment.id), method: :delete, class: "btn btn-outline-info" %>
  <% else %>
    <%= render 'public/likes/like_form', table: @comment %>
  <% end %>

</div>

<% @comment.replies.each do |reply| %>
  <div class="row py-3 border-bottom">
    <div class="col-6">
      <%= image_tag reply.end_user.get_image, size: "30x30", class: "rounded-circle" %>
      <span><%= reply.end_user.display_name %></span>
    </div>

    <div class="col-9 offset-1">
      <%= link_to reply_path(@post.end_user.display_name, reply.comment.post_id, reply.comment.id, reply.id), class: "text-decoration-none text-dark" do %>
        <i class="fas fa-solid fa-reply"></i> <%= reply.body %>
      <% end %>
    </div>
  </div>
<% end %>



<% if current_end_user.email != "guest@example.com" %>
  <div class=" mt-4  border-bottom">
    <%= form_with model: @reply, url: replies_path(@post.end_user.display_name, @post.id, @comment.id) do |f| %>
      <div class="col-11">
        <%= f.text_area :body,rows:'3',placeholder: "コメントをここに" , class: "form-control" %>
      </div>
      <div class="text-right">
        <%= f.submit "コメントする", class: "btn btn-outline-info" %>
      </div>
    <% end %>
  </div>
<% end %>