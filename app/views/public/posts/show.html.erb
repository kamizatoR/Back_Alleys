<div class="row mt-5">
    <div class="col-10 text-center">

      <div class="row mb-3">
          <%= link_to  timeline_path(@post.end_user.display_name), class: "text-decoration-none text-dark" do  %>
              <% if @post.end_user.image.attached? %>
                <%= image_tag @post.end_user.image, size: "40x40", class: "rounded-circle" %>
              <% end %>
            <strong><%= @post.end_user.display_name %> <i class="fas fa-paper-plane"></i></strong>
          <% end %>
      </div>
      <% if @post.image.attached? %>

        <div class="row justify-content-center">
          <%= image_tag @post.image, size: "350x200" %>
        </div>

      <% end %>
      <div class="row justify-content-center mt-4">
        <%= @post.body %>
      </div>

    </div>
    <% if end_user_signed_in? && @post.end_user_id == current_end_user.id  %>
      <div class="col-2 pl-0">
        <ul class="list-unstyled">
          <li class="mb-2">
            <%= link_to  edit_post_path(@post.end_user.display_name), class: "btn btn-outline-success" do %>
             編集 <i class="fas fa-solid fa-pen-to-square"></i>
            <% end %>
          </li>
          <li>
            <%= link_to  destroy_post_path(@post.end_user.display_name, @post.id), method: :delete, class: "btn btn-outline-danger", "data-confirm"=> "本当に削除しますか？" do %>
              削除 <i class="fas fa-solid fa-trash"></i>
            <% end %>
          </li>
        </ul>
      </div>
    <% end %>

</div>

<div class="row mt-5 mb-2 border-top border-bottom">
  <div class="col-5 pt-2 text-center">
    <i class="fas fa-comment"></i> <%= @post.comments.count %>件
  </div>
  <div class="col-5  pt-2">
    ♥ <%= @post.likes.count %>件
  </div>

  <% if current_end_user.liked_by?(@post.id) %>
    <%= link_to "♥", unliked_path(table_id: @post.id), method: :delete, class: "btn btn-outline-info" %>
  <% else %>
    <%= render 'public/likes/like_form', table: @post %>
  <% end %>

</div>

  <% @post.comments.each do |comment| %>
  <div class="row py-3 border-bottom">
    <div class="col-8">
      <% if comment.end_user.image.attached? %>
        <%= image_tag comment.end_user.image, size: "30x30", class: "rounded-circle" %>
      <% end %>
      <span><%= comment.end_user.display_name %></span>
    </div>

    <div class="col-9 offset-1">
      <%= link_to comment_path(comment.post.end_user.display_name, comment.post_id,comment.id), class: "text-decoration-none text-dark" do %>
        <i class="fas fa-comment"></i>  <%= comment.body %>
      <% end %>
    </div>
  </div>
  <% end %>

<% if current_end_user.email != "guest@example.com" %>
  <div class=" mt-4  border-bottom">
    <%= form_with model: [@post, @comment] , url: comments_path(@post.end_user.display_name, @post.id) do |f| %>
      <div class="col-11">
        <%= f.text_area :body,rows:'3',placeholder: "コメントをここに" , class: "form-control" %>
      </div>
      <div class="text-right">
        <%= f.submit "コメントする", class: "btn btn-outline-info" %>
      </div>
    <% end %>
  </div>
<% end %>
